<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Europa XS Build Log</title>
<style>
body { font-family: sans-serif; margin: 2rem; background:#f8f8f8; }
h1 { margin-bottom: 1.5rem; }
.category { margin-bottom: 2rem; }
.entry { background:white; margin:1rem 0; padding:1rem; border-radius:0.5rem; }
.photos { margin-top: 0.5rem; display: flex; flex-wrap: wrap; gap: 6px; }
.photos img { height:120px; border-radius:8px; cursor:pointer; transition: transform 0.2s; }
.photos img:hover { transform: scale(1.05); }
</style>
</head>
<body>
<h1>Europa XS Build Log</h1>
<div id="content"></div>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
Papa.parse("logs.csv", {
  download: true,
  header: true,
  complete: function(results) {
    const content = document.getElementById("content");

    // Group by category
    const grouped = {};
    results.data.forEach(row => {
      if (!row.Category) return;
      if (!grouped[row.Category]) grouped[row.Category] = [];
      grouped[row.Category].push(row);
    });

    // Sort categories alphabetically
    const sortedCategories = Object.keys(grouped).sort();

    sortedCategories.forEach(category => {
      const catDiv = document.createElement("div");
      catDiv.className = "category";
      const catTitle = document.createElement("h2");
      catTitle.textContent = category;
      catDiv.appendChild(catTitle);

      grouped[category]
        .sort((a, b) => new Date(a.Date) - new Date(b.Date)) // oldest to newest
        .forEach(entry => {
          const div = document.createElement("div");
          div.className = "entry";
          div.innerHTML = `<h3>${entry.Title || "(no title)"}</h3>
                           <p>${entry.Summary || ""}</p>`;

          // Try to load all JPGs from this category folder
          const photosDiv = document.createElement("div");
          photosDiv.className = "photos";

          // Assume up to 20 photos per category (adjustable)
          for (let i = 1; i <= 20; i++) {
            const imgPath = \`Photo Assets/${category}/${entry.ID || ""}-${i}.jpg\`;
            const img = document.createElement("img");
            img.src = imgPath;
            img.onerror = () => img.remove(); // hide if missing
            photosDiv.appendChild(img);
          }

          // Also show any JPGs that donâ€™t follow the ID pattern (fallback)
          const genericPath = \`Photo Assets/${category}/\`;
          for (let i = 0; i < 20; i++) {
            const img = document.createElement("img");
            img.src = \`\${genericPath}${i}.jpg\`;
            img.onerror = () => img.remove();
            photosDiv.appendChild(img);
          }

          div.appendChild(photosDiv);
          catDiv.appendChild(div);
        });

      content.appendChild(catDiv);
    });
  }
});
</script>
</body>
</html>
